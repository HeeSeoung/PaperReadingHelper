{%load static%}
<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>EPRH - English Paper Reading Helper</title>
    <link href="{% static 'css/mainpage.css' %}" rel="stylesheet">

    <!-- Custom fonts for this template-->
    <link href="{% static 'vendor/fontawesome-free/css/all.min.css' %}" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    
    <!-- Custom styles for this template-->
    <link href="{% static 'css/sb-admin-2.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">    

  </head>

  <body id="page-top">

    <!-- Page Wrapper -->
    <div id="wrapper">            
      <!-- Sidebar -->      

      <!-- End of Sidebar -->

      <!-- Content Wrapper -->
      <div id="content-wrapper" class="d-flex flex-column">

        <!-- Main Content -->
        <div id="content">

          <!-- Topbar -->
          {% include 'includes/header.html' %}
          <!-- End of Topbar -->

          <!-- Begin Page Content -->         
          <div class="row">
            <div class="col-xl-2 col-lg-2"></div>
            <div class="col-xl-4 col-lg-4">
              <div class="card shadow mb-4 text-center">
                <!-- Card Header - Dropdown -->
                <div class="card-header py-3 font-weight-bolder" id = "text-area" value="{{ paper_text }}">
                  OCR 텍스트
                </div>                
                <div class="card-body">
                  <p id="paper-text" class="mb-0" style='height: 500px;' value="{{ paper_text }}"></p>
                  <div id="text_area" align="center">              
                    <button class="btn btn-primary d-done" type="button" id="btn-trans">
                      변역하기
                    </button>
                    <a href='#' class="btn btn-primary d-done" type="button" id="btn-visual">
                      시각화
                    </a>        
                  </div>
                </div>                
              </div>
            </div>
            <div class="col-xl-4 col-lg-4">
              <div class="card shadow mb-4 text-center">
                <!-- Card Header - Dropdown -->
                <div class="card-header py-3 font-weight-bolder" id="image-area" value="{{ file_name }}">
                  업로드 한 이미지
                </div>                
                <div class="card-body">                  
                  <img id="paper-img" style='height: 500px;'>
                  <br>
                </div>                
              </div>
            </div>
            <div id="img-area" align="center">              
              <!-- <button class="btn btn-primary" type="button" id="btn-upload">
                유사 논문 찾기
              </button>                     -->
              <button class="btn btn-primary flex" type="button" id="btn-prev">이전</button>
              <button class="btn btn-primary flex" type="button" id="btn-next">다음</button>
              <br>
              
            </div>
            <div class="col-xl-2 col-lg-2"></div>
          </div>


        </div>
        <!-- End of Main Content -->

        <!-- Footer -->
        {% include 'includes/footer.html' %}
        <!-- End of Footer -->

      </div>
      <!-- End of Content Wrapper -->

    </div>
    <!-- End of Page Wrapper -->

    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
      <i class="fas fa-angle-up"></i>
    </a>

    <!-- Logout Modal-->
    <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
            <button class="close" type="button" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">×</span>
            </button>
          </div>
          <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
          <div class="modal-footer">
            <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
            <a class="btn btn-primary" href="/logout">Logout</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap core JavaScript-->
    <script>
        const btnUpload = document.getElementById('btn-upload');
        const paper_img = document.getElementById('paper-img');
        const paper_text = document.getElementById('paper-text');
        const text =  document.getElementById('paper-text').value;
        console.log(text);
        const btnVisual = document.getElementById('btn-visual');
        let paper_order = 0;
        let result;
        let file_name_path;

        file_name_path = file_name_reload;
        console.log(file_name_path);
        paper_img.style.height = '500px';
        paper_img.src = "media/"+file_name_path+"/"+file_name_path+String(paper_order)+".png";
        console.log(paper_img.src);
        document.getElementById('btn-visual').setAttribute('href', `/visual?filename={{file_name}}`)     
        paper_text.innerText = text[0];
                
        const btnNext = document.getElementById('btn-next');
        btnNext.addEventListener('click', () => {
            console.log(result.paper_text.length);
            console.log(paper_order);
            if (paper_order < text.length - 1){            
                paper_order ++;
                paper_img.src = "media/"+file_name_path+"/"+file_name_path+String(paper_order)+".png";
                paper_text.innerText = text[paper_order];
            }
        })
        const btnPrev = document.getElementById('btn-prev');
        btnPrev.addEventListener('click', () => {
            if (paper_order > 0){            
                paper_order --;
                paper_img.src = "media/"+file_name_path+"/"+file_name_path+String(paper_order)+".png";
                paper_text.innerText = text[paper_order];
            }
        })

        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                        const cookie = cookies[i].trim();
                        // Does this cookie string begin with the name we want?
                        if (cookie.substring(0, name.length + 1) === (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                        }
                    }
                }
            return cookieValue;
            }
    </script>

    <script src="{% static 'vendor/jquery/jquery.min.js' %}" defer="defer"></script>
    <script src="{% static 'vendor/bootstrap/js/bootstrap.bundle.min.js' %}" defer="defer"></script>

    <!-- Core plugin JavaScript-->
    <script src="{% static 'vendor/jquery-easing/jquery.easing.min.js' %}" defer="defer"></script>

    <!-- Custom scripts for all pages-->
    <script src="{% static 'js/sb-admin-2.min.js' %}" defer="defer"></script>
    <script src="{% static 'js/mypage/script_detail.js' %}" defer="defer"></script>
    <script src="{% static 'js/mainpage.js' %}" defer="defer"></script>
  </body>

</html>